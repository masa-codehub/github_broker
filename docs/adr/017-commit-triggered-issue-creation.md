# 概要 / Summary
[ADR-XXX] コミットトリガーによるIssue自動起票ワークフローの導入

- **Status**: 提案中
- **Date**: 2025-11-20

## 状況 / Context

現在、プロジェクトにはGitHubのイベントをポーリングし、Issueのライフサイクル管理やエージェントへのタスク割り当てを行う`github_broker`が存在します。`ADR-003: ポーリング方式アーキテクチャへの完全移行` および `ADR-009: ロングポーリング方式の廃止とシンプルポーリングへの切り替え` により、`github_broker`はWebhookベースのプッシュ型イベント処理から、ポーリングベースのプル型イベント処理へと完全に移行しています。

ユーザーから「コミットされたらIssueを起票する仕組み」を、`github_broker`に依存せず汎用的な形で実装したいという要望がありました。これは、GitHubの`push`イベントをトリガーとするプッシュ型の処理であり、既存の`github_broker`のアーキテクチャ（ポーリング主体）では直接サポートされていません。また、汎用性を高めるためには、プロジェクト固有の`github_broker`から分離された形で実装されるべきです。

## 決定 / Decision

GitHubの`push`イベントをトリガーとしてIssueを自動起票する機能は、**GitHub Actions Workflow** として`.github/workflows/` ディレクトリに実装します。

このワークフローは以下の要件を満たします。

*   `on: push` イベントをトリガーとする。
*   コミットメッセージやコミットされたファイルの変更内容に基づいて、Issueのタイトルと本文を動的に生成する。
*   `gh cli` または `actions/github-script` などのGitHub公式アクションを使用してIssueを作成する。
*   特定のコミットパターン（例: "feat:", "bugfix:" など）にのみ反応するようにフィルターを設けることも可能とする（詳細設計で決定）。

## 結果 / Consequences

### メリット (Positive consequences)

- **汎用性と再利用性:** プロジェクト固有の`github_broker`に依存しないため、他のGitHubリポジトリにも容易に適用可能となり、汎用性が大幅に向上します。
- **既存アーキテクチャとの非干渉:** `github_broker`の既存のポーリングベースのアーキテクチャに影響を与えることなく、新しい機能を追加できます。
- **リアルタイム性:** コミットがプッシュされた直後にワークフローが実行されるため、Issueの起票が迅速に行われます。
- **メンテナンス性:** GitHubのネイティブ機能として提供されるため、メンテナンスが容易であり、GitHub Actionsのエコシステムを活用できます。
- **セキュリティ:** GitHub Actionsの標準的な認証・認可メカニズムにより、セキュアに運用できます。

### デメリット (Negative consequences)

- **ロジックの管理:** 複雑なIssue本文の生成ロジックはYAMLファイル内またはシェルスクリプト内に記述されるため、Pythonなどの言語で書かれたロジックと比較して管理がやや難しくなる可能性があります。これは、専用のスクリプトを別途用意し、GitHub Actionsから呼び出すことで緩和できます。
- **既存システムとの独立:** `github_broker`のポーリングシステムとは完全に独立して動作するため、両システム間の連携が必要な場合は別途考慮が必要です（現状の要求では不要）。

## 検証基準 / Verification Criteria

- 特定のコミット（例: "feat: 新機能" というコミットメッセージを含むプッシュ）がリポジトリにプッシュされた際、GitHubリポジトリに新しいIssueが自動的に作成されること。
- 作成されたIssueのタイトルと本文が、コミットメッセージや関連情報に基づいて適切に生成されていること。
- ワークフローの実行ログにおいて、エラーなくIssueが作成されたことが確認できること。

## 実装状況 / Implementation Status
未着手
