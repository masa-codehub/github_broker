## 調査報告書：自律型エージェント向けタスクブローカーのベンチマーキング調査

### 1. 調査サマリー (Executive Summary)
本調査から得られた最も重要な結論を3行で要約します。
- 主要な自律型エージェントフレームワーク（AutoGen, CrewAI）は、中央集権的なオーケストレーターまたはマネージャーエージェントを通じてタスクを割り当てるアーキテクチャを採用しています。
- 状態管理は、シンプルなインメモリから、ファイルシステム（SQLite, ChromaDB）や外部データベース（Redis, PostgreSQL）を利用した永続化まで、ユースケースに応じて拡張可能な設計が一般的です。
- 各フレームワークは、特定のペルソナ（研究者、開発者）と解決したい課題（柔軟な対話、階層的なタスク分解）に応じて、独自の価値（イベント駆動、ロールプレイング）を提供しており、我々のプロダクトの差別化の参考になります。

### 2. 調査目的と仮説 (Purpose & Hypothesis)
- **目的:** 類似のOSSプロジェクトや技術記事を調査し、彼らが「どのようなユーザーの、何を解決しようとしているのか」を明らかにします。その上で、タスク割り当てロジック、堅牢性、スケーラビリティ等の観点で参考になる知見を収集し、本Issueへのコメントとして報告します。
- **仮説:** 「ユーザーはこの領域のプロダクトに、機能の多様性だけでなく、堅牢性やスケーラビリティを求めており、高機能でありながら使いやすいブローカーには市場機会があるのではないか」

### 3. 調査プロセス (Methodology)
- **調査期間:** 2025-09-02
- **主な情報源:** Google Search, GitHub, 技術ブログ (Medium, etc.)
- **主な検索キーワード:** "autonomous agent task broker open source", "multi-agent system task allocation", "AutoGen architecture", "CrewAI architecture", "Agent Squad architecture"

### 4. 調査結果 (Findings)
収集した客観的な事実を、3つの主要なOSSプロジェクトについて記載します。

---

### **《競合A: Microsoft AutoGen》**

- **想定ペルソナと解決課題:**
    - **想定ペルソナ:** 主に、複雑なワークフローや会話フローを持つマルチエージェントアプリケーションを構築したい研究者や開発者。
    - **解決課題:** 複数のエージェント間で、柔軟かつ動的な会話（タスク遂行）を実現すること。特に、静的な順序では解決できない複雑な問題解決の自動化を目指しています。
- **独自の価値提案:**
    - **イベント駆動アーキテクチャ:** エージェント間のやり取りをイベントとして扱うことで、高い柔軟性と拡張性を実現しています。
    - **多様な会話パターン:** 2つのエージェント間の会話だけでなく、グループチャットや階層的な会話など、様々なコミュニケーションパターンをサポートします。
- **アーキテクチャ:**
    - **イベント駆動型アクターモデル:** 各エージェントがアクターとして振る舞い、イベントを介して非同期に通信します。中央集権的なメッセージングコンポーネントがメッセージ配信を管理します。
    - **分散ランタイム:** エージェントを異なるプロセスやマシンで実行できるため、スケーラビリティに優れています。
- **タスク割り当てロジック:**
    - **会話ベースの委任:** 明示的なタスクキューではなく、エージェント間の会話の流れの中でタスクが自然に委任・実行されます。「マネージャー」役のエージェントが、他のエージェントにタスクを割り振る会話パターンを構築できます。
- **状態管理:**
    - **インメモリが基本:** デフォルトでは、会話の履歴や状態は実行中のメモリ内で管理されます。
    - **拡張による永続化:** 必要に応じて、開発者が独自にデータベースやファイルシステムに状態を保存するロジックを実装する必要があります。

---

### **《競合B: CrewAI》**

- **想定ペルソナと解決課題:**
    - **想定ペルソナ:** 特定の役割（例：リサーチャー、ライター）を持つエージェントを組み合わせて、具体的なビジネスプロセス（例：市場調査レポート作成）を自動化したい開発者やビジネスユーザー。
    - **解決課題:** 役割ベースの自律型AIエージェントの協調作業を簡単にオーケストレーションすること。
- **独自の価値提案:**
    - **ロールプレイングアプローチ:** エージェントに明確な役割（`role`）と目標（`goal`）を与えることで、直感的にクルー（チーム）を設計できます。
    - **階層的プロセス:** マネージャーエージェントがタスクを部下に動的に委任し、結果をレビューする階層的なワークフローを簡単に構築できます。
- **アーキテクチャ:**
    - **中央集権型オーケストレーター:** `Crew`オブジェクトがオーケストレーターとして機能し、定義されたプロセス（シーケンシャルまたは階層的）に従ってタスク全体を管理します。
- **タスク割り当てロジック:**
    - **プロセスベース:**
        - **シーケンシャル:** 定義されたタスクリストの順序通りに、タスクを一つずつ実行します。
        - **階層的:** マネージャーエージェントが、タスクの内容に応じて最適なエージェントに動的にタスクを割り当てます。
- **状態管理:**
    - **インメモリ＋ローカルファイル:** `Task`オブジェクトが実行結果をインメモリで保持します。`memory=True`とすることで、ローカルのSQLiteとChromaDBを使用して、タスクの履歴やエージェントの記憶を永続化できます。
    - **外部ストレージへの拡張:** カスタム実装により、PostgreSQLやRedisなどの外部データベースに状態を保存することが可能です。

---

### **《競合C: Agent Squad (概念)》**

- **想定ペルソナと解決課題:**
    - **想定ペルソナ:** スケーラブルで耐障害性の高い、本番環境レベルのマルチエージェントシステムを構築したいシステムアーキテクトや開発者。
    - **解決課題:** 多数のエージェントが関わる複雑なタスクを、非同期かつ堅牢に処理するためのシステム基盤を構築すること。
- **独自の価値提案:**
    - **疎結合と耐障害性:** タスクキューを介した非同期通信により、特定のエージェントの障害がシステム全体に波及しにくい、回復力の高いシステムを実現します。
- **アーキテクチャ:**
    - **分散タスクキューモデル:** RabbitMQやRedisのようなメッセージブローカー（タスクキュー）をシステムの中心に配置します。プロデューサーがタスクをキューに投入し、ワーカー（エージェント）がキューからタスクを取得して実行します。
    - **Orchestration vs. Choreography:**
        - **Orchestration:** 中央の司令塔エージェントがワークフローを管理します。
        - **Choreography:** 各エージェントがイベントを購読し、自律的に連携します。
- **タスク割り当てロジック:**
    - **プル型:** 各エージェントが自律的にタスクキューから処理すべきタスクを取得（プル）します。これにより、エージェントの負荷に応じた自然な負荷分散が実現されます。
- **状態管理:**
    - **永続化が前提:** タスクの状態（待機中、実行中、完了、失敗）や実行結果は、PostgreSQLなどのデータベースに永続的に保存されることが一般的です。これにより、タスクの追跡や失敗時の再試行が容易になります。

### 5. 分析と洞察 (Analysis & Insights)
- **仮説の検証結果:** 当初の仮説「ユーザーは堅牢性やスケーラビリティを求めており、高機能かつ使いやすいブローカーに市場機会がある」は、今回の調査によって強く支持されました。各フレームワークは、単なる機能提供だけでなく、特定の開発スタイルやユースケースに合わせたアーキテクチャ（イベント駆動、階層的プロセス、分散キュー）を提供することで、堅牢性やスケーラビリティという非機能要件に応えようとしています。
- **結論:** 自律型エージェントのタスクブローカー市場は、単一の支配的なアーキテクチャは存在せず、解決したい課題の性質（対話の柔軟性、プロセスの自動化、システムの堅牢性）に応じて、多様なアプローチが共存しています。我々のプロダクトが成功するためには、ターゲットとするユーザーペルソナとユースケースを明確にし、それに最適化されたアーキテクチャと独自の価値を提供することが不可欠です。
- **提案/インサイト:**
    - **ターゲットの明確化:** 我々の`github_broker`が、AutoGenのような「研究開発向けの高柔軟性」を目指すのか、CrewAIのような「ビジネスプロセス自動化向けの実用性」を目指すのか、あるいはAgent Squadのコンセプトのような「本番環境向けの堅牢性」を最優先するのか、戦略的な方向性を定めるべきです。
    - **状態管理の強化:** CrewAIが提供するような、ローカルファイルへの簡単な永続化機能は、開発者体験を大きく向上させるため、我々のプロダクトにも導入を検討する価値があります。
    - **タスク割り当ての柔軟性:** CrewAIの「階層的プロセス」のように、静的なキューだけでなく、状況に応じて動的にタスクを割り当てるロジックは、より高度なユースケースに対応するために重要です。

### 6. 参照情報 (References)
- **AutoGen:**
    - https://microsoft.github.io/autogen/
- **CrewAI:**
    - https://docs.crewai.com/
- **Agent Squad (Conceptual):**
    - https://www.confluent.jp/blog/four-design-patterns-for-event-driven-multi-agent-systems/
    - https://learn.microsoft.com/ja-jp/azure/architecture/guide/ai/agent-orchestration-patterns
